{"version":3,"sources":["@wordpress/block-editor/src/store/actions.js"],"names":["castArray","maybeArray","Array","isArray","resetBlocks","blocks","dispatch","type","validateBlocksToTemplate","select","template","getTemplate","templateLock","getTemplateLock","isBlocksValidToTemplate","isValidTemplate","setTemplateValidity","resetSelection","selectionStart","selectionEnd","initialPosition","receiveBlocks","since","alternative","updateBlockAttributes","clientIds","attributes","uniqueByBlock","updateBlock","clientId","updates","selectBlock","selectPreviousBlock","fallbackToParent","previousBlockClientId","getPreviousBlockClientId","firstParentClientId","getBlockRootClientId","selectNextBlock","nextBlockClientId","getNextBlockClientId","startMultiSelect","stopMultiSelect","multiSelect","start","end","__experimentalInitialPosition","startBlockRootClientId","endBlockRootClientId","blockCount","getSelectedBlockCount","clearSelectedBlock","toggleSelection","isSelectionEnabled","getBlocksWithDefaultStylesApplied","blockEditorSettings","preferredStyleVariations","__experimentalPreferredStyleVariations","value","map","block","blockName","name","className","includes","blockStyle","trim","replaceBlocks","indexToSelect","meta","getSettings","rootClientId","index","length","canInsertBlock","canInsertBlockType","time","Date","now","replaceBlock","createOnMove","canMoveBlocks","moveBlocksDown","moveBlocksUp","moveBlocksToPosition","fromRootClientId","toRootClientId","canRemoveBlocks","canInsertBlocks","moveBlockToPosition","insertBlock","updateSelection","insertBlocks","hint","allowedBlocks","isValid","push","showInsertionPoint","__unstableOptions","__unstableWithInserter","operation","hideInsertionPoint","isBlockInsertionPointVisible","synchronizeTemplate","getBlocks","updatedBlockList","__unstableDeleteSelection","isForward","registry","selectionAnchor","getSelectionStart","selectionFocus","getSelectionEnd","attributeKey","offset","anchorRootClientId","focusRootClientId","blockOrder","getBlockOrder","anchorIndex","indexOf","focusIndex","targetSelection","targetBlock","getBlock","targetBlockType","merge","selectionA","selectionB","blockA","blockAType","blockB","blockBType","htmlA","htmlB","attributeDefinitionA","attributeDefinitionB","valueA","html","valueB","text","START_OF_SELECTED_AREA","cloneA","cloneB","followingBlock","blocksWithTheSameType","updatedAttributes","blockToMerge","pop","shift","newAttributeKey","convertedHtml","convertedValue","newOffset","newValue","newHtml","selectedBlockClientIds","getSelectedBlockClientIds","replacement","batch","selectionChange","getSelectedBlocksInitialCaretPosition","__unstableSplitSelection","__unstableExpandSelection","mergeBlocks","firstBlockClientId","secondBlockClientId","clientIdA","clientIdB","blockWithSameType","innerBlocks","undefined","removeBlock","selectedBlockType","attributeDefinition","canRestoreTextSelection","window","console","error","selectedBlock","slice","removeBlocks","selectPrevious","replaceInnerBlocks","toggleBlockMode","startTyping","stopTyping","startDraggingBlocks","stopDraggingBlocks","enterFormattedText","version","exitFormattedText","startOffset","endOffset","insertDefaultBlock","defaultBlockName","updateBlockListSettings","settings","updateSettings","stripExperimentalSettings","__unstableSaveReusableBlock","id","updatedId","__unstableMarkLastChangeAsPersistent","__unstableMarkNextChangeAsNotPersistent","__unstableMarkAutomaticChange","requestIdleCallback","cb","setTimeout","setNavigationMode","isNavigationMode","__unstableSetEditorMode","mode","firstSelectedClientId","getBlockSelectionStart","getBlockHierarchyRootClientId","setBlockMovingClientId","hasBlockMovingClientId","duplicateBlocks","getBlocksByClientId","some","blockNames","clientIdsArray","lastSelectedIndex","getBlockIndex","clonedBlocks","insertBeforeBlock","isLocked","firstSelectedIndex","insertAfterBlock","toggleBlockHighlight","isHighlighted","flashBlock","Promise","resolve","setHasControlledInnerBlocks","hasControlledInnerBlocks","setBlockVisibility","__unstableSetTemporarilyEditingAsBlocks","temporarilyEditingAsBlocks","registerInserterMediaCategory","category","labels","mediaType","fetch","inserterMediaCategories","isExternalResource"],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACO,MAAMC,6BAA6B,GACvCC,QAAF,IACA,CAAE;AAAExO,EAAAA,MAAF;AAAUH,EAAAA;AAAV,CAAF,KAA4B;AAC3B,MAAK,CAAE2O,QAAF,IAAc,OAAOA,QAAP,KAAoB,QAAvC,EAAkD;AACjDhE,IAAAA,OAAO,CAACC,KAAR,CACC,uDADD;AAGA;AACA;;AACD,MAAK,CAAE+D,QAAQ,CAACnL,IAAhB,EAAuB;AACtBmH,IAAAA,OAAO,CAACC,KAAR,CACC,iFADD;AAGA;AACA;;AACD,MAAK,CAAE+D,QAAQ,CAACC,MAAT,EAAiBpL,IAAxB,EAA+B;AAC9BmH,IAAAA,OAAO,CAACC,KAAR,CAAe,uCAAf;AACA;AACA;;AACD,MAAK,CAAE,CAAE,OAAF,EAAW,OAAX,EAAoB,OAApB,EAA8BlH,QAA9B,CAAwCiL,QAAQ,CAACE,SAAjD,CAAP,EAAsE;AACrElE,IAAAA,OAAO,CAACC,KAAR,CACC,+EADD;AAGA;AACA;;AACD,MAAK,CAAE+D,QAAQ,CAACG,KAAX,IAAoB,OAAOH,QAAQ,CAACG,KAAhB,KAA0B,UAAnD,EAAgE;AAC/DnE,IAAAA,OAAO,CAACC,KAAR,CACC,wIADD;AAGA;AACA;;AACD,QAAM;AAAEmE,IAAAA,uBAAuB,GAAG;AAA5B,MAAmC5O,MAAM,CAAC6D,WAAP,EAAzC;;AACA,MACC+K,uBAAuB,CAACzB,IAAxB,CACC,CAAE;AAAE9J,IAAAA;AAAF,GAAF,KAAgBA,IAAI,KAAKmL,QAAQ,CAACnL,IADnC,CADD,EAIE;AACDmH,IAAAA,OAAO,CAACC,KAAR,CACE,yDAAyD+D,QAAQ,CAACnL,IAAM,IAD1E;AAGA;AACA;;AACD,MACCuL,uBAAuB,CAACzB,IAAxB,CACC,CAAE;AAAEsB,IAAAA,MAAM,EAAE;AAAEpL,MAAAA;AAAF;AAAV,GAAF,KAA4BA,IAAI,KAAKmL,QAAQ,CAACC,MAAT,EAAiBpL,IADvD,CADD,EAIE;AACDmH,IAAAA,OAAO,CAACC,KAAR,CACE,gEAAgE+D,QAAQ,CAACC,MAAT,CAAgBpL,IAAM,IADxF;AAGA;AACA,GAjD0B,CAkD3B;AACA;AACA;AACA;;;AACAxD,EAAAA,QAAQ,CAAE;AACTC,IAAAA,IAAI,EAAE,iBADG;AAET8L,IAAAA,QAAQ,EAAE;AACTgD,MAAAA,uBAAuB,EAAE,CACxB,GAAGA,uBADqB,EAExB,EAAE,GAAGJ,QAAL;AAAeK,QAAAA,kBAAkB,EAAE;AAAnC,OAFwB;AADhB;AAFD,GAAF,CAAR;AASA,CAjEK","sourcesContent":["/* eslint no-console: [ 'error', { allow: [ 'error', 'warn' ] } ] */\n/**\n * WordPress dependencies\n */\nimport {\n\tcloneBlock,\n\t__experimentalCloneSanitizedBlock,\n\tcreateBlock,\n\tdoBlocksMatchTemplate,\n\tgetBlockType,\n\tgetDefaultBlockName,\n\thasBlockSupport,\n\tswitchToBlockType,\n\tsynchronizeBlocksWithTemplate,\n} from '@wordpress/blocks';\nimport { speak } from '@wordpress/a11y';\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { create, insert, remove, toHTMLString } from '@wordpress/rich-text';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport { mapRichTextSettings } from './utils';\nimport {\n\tretrieveSelectedAttribute,\n\tSTART_OF_SELECTED_AREA,\n} from '../utils/selection';\nimport {\n\t__experimentalUpdateSettings,\n\tensureDefaultBlock,\n\tprivateRemoveBlocks,\n} from './private-actions';\n\n/** @typedef {import('../components/use-on-block-drop/types').WPDropOperation} WPDropOperation */\n\nconst castArray = ( maybeArray ) =>\n\tArray.isArray( maybeArray ) ? maybeArray : [ maybeArray ];\n\n/**\n * Action that resets blocks state to the specified array of blocks, taking precedence\n * over any other content reflected as an edit in state.\n *\n * @param {Array} blocks Array of blocks.\n */\nexport const resetBlocks =\n\t( blocks ) =>\n\t( { dispatch } ) => {\n\t\tdispatch( { type: 'RESET_BLOCKS', blocks } );\n\t\tdispatch( validateBlocksToTemplate( blocks ) );\n\t};\n\n/**\n * Block validity is a function of blocks state (at the point of a\n * reset) and the template setting. As a compromise to its placement\n * across distinct parts of state, it is implemented here as a side\n * effect of the block reset action.\n *\n * @param {Array} blocks Array of blocks.\n */\nexport const validateBlocksToTemplate =\n\t( blocks ) =>\n\t( { select, dispatch } ) => {\n\t\tconst template = select.getTemplate();\n\t\tconst templateLock = select.getTemplateLock();\n\n\t\t// Unlocked templates are considered always valid because they act\n\t\t// as default values only.\n\t\tconst isBlocksValidToTemplate =\n\t\t\t! template ||\n\t\t\ttemplateLock !== 'all' ||\n\t\t\tdoBlocksMatchTemplate( blocks, template );\n\n\t\t// Update if validity has changed.\n\t\tconst isValidTemplate = select.isValidTemplate();\n\n\t\tif ( isBlocksValidToTemplate !== isValidTemplate ) {\n\t\t\tdispatch.setTemplateValidity( isBlocksValidToTemplate );\n\t\t\treturn isBlocksValidToTemplate;\n\t\t}\n\t};\n\n/**\n * A block selection object.\n *\n * @typedef {Object} WPBlockSelection\n *\n * @property {string} clientId     A block client ID.\n * @property {string} attributeKey A block attribute key.\n * @property {number} offset       An attribute value offset, based on the rich\n *                                 text value. See `wp.richText.create`.\n */\n\n/**\n * A selection object.\n *\n * @typedef {Object} WPSelection\n *\n * @property {WPBlockSelection} start The selection start.\n * @property {WPBlockSelection} end   The selection end.\n */\n\n/* eslint-disable jsdoc/valid-types */\n/**\n * Returns an action object used in signalling that selection state should be\n * reset to the specified selection.\n *\n * @param {WPBlockSelection} selectionStart  The selection start.\n * @param {WPBlockSelection} selectionEnd    The selection end.\n * @param {0|-1|null}        initialPosition Initial block position.\n *\n * @return {Object} Action object.\n */\nexport function resetSelection(\n\tselectionStart,\n\tselectionEnd,\n\tinitialPosition\n) {\n\t/* eslint-enable jsdoc/valid-types */\n\treturn {\n\t\ttype: 'RESET_SELECTION',\n\t\tselectionStart,\n\t\tselectionEnd,\n\t\tinitialPosition,\n\t};\n}\n\n/**\n * Returns an action object used in signalling that blocks have been received.\n * Unlike resetBlocks, these should be appended to the existing known set, not\n * replacing.\n *\n * @deprecated\n *\n * @param {Object[]} blocks Array of block objects.\n *\n * @return {Object} Action object.\n */\nexport function receiveBlocks( blocks ) {\n\tdeprecated( 'wp.data.dispatch( \"core/block-editor\" ).receiveBlocks', {\n\t\tsince: '5.9',\n\t\talternative: 'resetBlocks or insertBlocks',\n\t} );\n\n\treturn {\n\t\ttype: 'RECEIVE_BLOCKS',\n\t\tblocks,\n\t};\n}\n\n/**\n * Action that updates attributes of multiple blocks with the specified client IDs.\n *\n * @param {string|string[]} clientIds     Block client IDs.\n * @param {Object}          attributes    Block attributes to be merged. Should be keyed by clientIds if\n *                                        uniqueByBlock is true.\n * @param {boolean}         uniqueByBlock true if each block in clientIds array has a unique set of attributes\n * @return {Object} Action object.\n */\nexport function updateBlockAttributes(\n\tclientIds,\n\tattributes,\n\tuniqueByBlock = false\n) {\n\treturn {\n\t\ttype: 'UPDATE_BLOCK_ATTRIBUTES',\n\t\tclientIds: castArray( clientIds ),\n\t\tattributes,\n\t\tuniqueByBlock,\n\t};\n}\n\n/**\n * Action that updates the block with the specified client ID.\n *\n * @param {string} clientId Block client ID.\n * @param {Object} updates  Block attributes to be merged.\n *\n * @return {Object} Action object.\n */\nexport function updateBlock( clientId, updates ) {\n\treturn {\n\t\ttype: 'UPDATE_BLOCK',\n\t\tclientId,\n\t\tupdates,\n\t};\n}\n\n/* eslint-disable jsdoc/valid-types */\n/**\n * Returns an action object used in signalling that the block with the\n * specified client ID has been selected, optionally accepting a position\n * value reflecting its selection directionality. An initialPosition of -1\n * reflects a reverse selection.\n *\n * @param {string}    clientId        Block client ID.\n * @param {0|-1|null} initialPosition Optional initial position. Pass as -1 to\n *                                    reflect reverse selection.\n *\n * @return {Object} Action object.\n */\nexport function selectBlock( clientId, initialPosition = 0 ) {\n\t/* eslint-enable jsdoc/valid-types */\n\treturn {\n\t\ttype: 'SELECT_BLOCK',\n\t\tinitialPosition,\n\t\tclientId,\n\t};\n}\n\n/**\n * Yields action objects used in signalling that the block preceding the given\n * clientId (or optionally, its first parent from bottom to top)\n * should be selected.\n *\n * @param {string}  clientId         Block client ID.\n * @param {boolean} fallbackToParent If true, select the first parent if there is no previous block.\n */\nexport const selectPreviousBlock =\n\t( clientId, fallbackToParent = false ) =>\n\t( { select, dispatch } ) => {\n\t\tconst previousBlockClientId =\n\t\t\tselect.getPreviousBlockClientId( clientId );\n\t\tif ( previousBlockClientId ) {\n\t\t\tdispatch.selectBlock( previousBlockClientId, -1 );\n\t\t} else if ( fallbackToParent ) {\n\t\t\tconst firstParentClientId = select.getBlockRootClientId( clientId );\n\t\t\tif ( firstParentClientId ) {\n\t\t\t\tdispatch.selectBlock( firstParentClientId, -1 );\n\t\t\t}\n\t\t}\n\t};\n\n/**\n * Yields action objects used in signalling that the block following the given\n * clientId should be selected.\n *\n * @param {string} clientId Block client ID.\n */\nexport const selectNextBlock =\n\t( clientId ) =>\n\t( { select, dispatch } ) => {\n\t\tconst nextBlockClientId = select.getNextBlockClientId( clientId );\n\t\tif ( nextBlockClientId ) {\n\t\t\tdispatch.selectBlock( nextBlockClientId );\n\t\t}\n\t};\n\n/**\n * Action that starts block multi-selection.\n *\n * @return {Object} Action object.\n */\nexport function startMultiSelect() {\n\treturn {\n\t\ttype: 'START_MULTI_SELECT',\n\t};\n}\n\n/**\n * Action that stops block multi-selection.\n *\n * @return {Object} Action object.\n */\nexport function stopMultiSelect() {\n\treturn {\n\t\ttype: 'STOP_MULTI_SELECT',\n\t};\n}\n\n/**\n * Action that changes block multi-selection.\n *\n * @param {string}      start                         First block of the multi selection.\n * @param {string}      end                           Last block of the multiselection.\n * @param {number|null} __experimentalInitialPosition Optional initial position. Pass as null to skip focus within editor canvas.\n */\nexport const multiSelect =\n\t( start, end, __experimentalInitialPosition = 0 ) =>\n\t( { select, dispatch } ) => {\n\t\tconst startBlockRootClientId = select.getBlockRootClientId( start );\n\t\tconst endBlockRootClientId = select.getBlockRootClientId( end );\n\n\t\t// Only allow block multi-selections at the same level.\n\t\tif ( startBlockRootClientId !== endBlockRootClientId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdispatch( {\n\t\t\ttype: 'MULTI_SELECT',\n\t\t\tstart,\n\t\t\tend,\n\t\t\tinitialPosition: __experimentalInitialPosition,\n\t\t} );\n\n\t\tconst blockCount = select.getSelectedBlockCount();\n\n\t\tspeak(\n\t\t\tsprintf(\n\t\t\t\t/* translators: %s: number of selected blocks */\n\t\t\t\t_n( '%s block selected.', '%s blocks selected.', blockCount ),\n\t\t\t\tblockCount\n\t\t\t),\n\t\t\t'assertive'\n\t\t);\n\t};\n\n/**\n * Action that clears the block selection.\n *\n * @return {Object} Action object.\n */\nexport function clearSelectedBlock() {\n\treturn {\n\t\ttype: 'CLEAR_SELECTED_BLOCK',\n\t};\n}\n\n/**\n * Action that enables or disables block selection.\n *\n * @param {boolean} [isSelectionEnabled=true] Whether block selection should\n *                                            be enabled.\n *\n * @return {Object} Action object.\n */\nexport function toggleSelection( isSelectionEnabled = true ) {\n\treturn {\n\t\ttype: 'TOGGLE_SELECTION',\n\t\tisSelectionEnabled,\n\t};\n}\n\nfunction getBlocksWithDefaultStylesApplied( blocks, blockEditorSettings ) {\n\tconst preferredStyleVariations =\n\t\tblockEditorSettings?.__experimentalPreferredStyleVariations?.value ??\n\t\t{};\n\treturn blocks.map( ( block ) => {\n\t\tconst blockName = block.name;\n\t\tif ( ! hasBlockSupport( blockName, 'defaultStylePicker', true ) ) {\n\t\t\treturn block;\n\t\t}\n\t\tif ( ! preferredStyleVariations[ blockName ] ) {\n\t\t\treturn block;\n\t\t}\n\t\tconst className = block.attributes?.className;\n\t\tif ( className?.includes( 'is-style-' ) ) {\n\t\t\treturn block;\n\t\t}\n\t\tconst { attributes = {} } = block;\n\t\tconst blockStyle = preferredStyleVariations[ blockName ];\n\t\treturn {\n\t\t\t...block,\n\t\t\tattributes: {\n\t\t\t\t...attributes,\n\t\t\t\tclassName: `${\n\t\t\t\t\tclassName || ''\n\t\t\t\t} is-style-${ blockStyle }`.trim(),\n\t\t\t},\n\t\t};\n\t} );\n}\n\n/* eslint-disable jsdoc/valid-types */\n/**\n * Action that replaces given blocks with one or more replacement blocks.\n *\n * @param {(string|string[])} clientIds       Block client ID(s) to replace.\n * @param {(Object|Object[])} blocks          Replacement block(s).\n * @param {number}            indexToSelect   Index of replacement block to select.\n * @param {0|-1|null}         initialPosition Index of caret after in the selected block after the operation.\n * @param {?Object}           meta            Optional Meta values to be passed to the action object.\n *\n * @return {Object} Action object.\n */\nexport const replaceBlocks =\n\t( clientIds, blocks, indexToSelect, initialPosition = 0, meta ) =>\n\t( { select, dispatch } ) => {\n\t\t/* eslint-enable jsdoc/valid-types */\n\t\tclientIds = castArray( clientIds );\n\t\tblocks = getBlocksWithDefaultStylesApplied(\n\t\t\tcastArray( blocks ),\n\t\t\tselect.getSettings()\n\t\t);\n\t\tconst rootClientId = select.getBlockRootClientId( clientIds[ 0 ] );\n\t\t// Replace is valid if the new blocks can be inserted in the root block.\n\t\tfor ( let index = 0; index < blocks.length; index++ ) {\n\t\t\tconst block = blocks[ index ];\n\t\t\tconst canInsertBlock = select.canInsertBlockType(\n\t\t\t\tblock.name,\n\t\t\t\trootClientId\n\t\t\t);\n\t\t\tif ( ! canInsertBlock ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tdispatch( {\n\t\t\ttype: 'REPLACE_BLOCKS',\n\t\t\tclientIds,\n\t\t\tblocks,\n\t\t\ttime: Date.now(),\n\t\t\tindexToSelect,\n\t\t\tinitialPosition,\n\t\t\tmeta,\n\t\t} );\n\t\tdispatch( ensureDefaultBlock() );\n\t};\n\n/**\n * Action that replaces a single block with one or more replacement blocks.\n *\n * @param {(string|string[])} clientId Block client ID to replace.\n * @param {(Object|Object[])} block    Replacement block(s).\n *\n * @return {Object} Action object.\n */\nexport function replaceBlock( clientId, block ) {\n\treturn replaceBlocks( clientId, block );\n}\n\n/**\n * Higher-order action creator which, given the action type to dispatch creates\n * an action creator for managing block movement.\n *\n * @param {string} type Action type to dispatch.\n *\n * @return {Function} Action creator.\n */\nconst createOnMove =\n\t( type ) =>\n\t( clientIds, rootClientId ) =>\n\t( { select, dispatch } ) => {\n\t\t// If one of the blocks is locked or the parent is locked, we cannot move any block.\n\t\tconst canMoveBlocks = select.canMoveBlocks( clientIds, rootClientId );\n\t\tif ( ! canMoveBlocks ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdispatch( { type, clientIds: castArray( clientIds ), rootClientId } );\n\t};\n\nexport const moveBlocksDown = createOnMove( 'MOVE_BLOCKS_DOWN' );\nexport const moveBlocksUp = createOnMove( 'MOVE_BLOCKS_UP' );\n\n/**\n * Action that moves given blocks to a new position.\n *\n * @param {?string} clientIds        The client IDs of the blocks.\n * @param {?string} fromRootClientId Root client ID source.\n * @param {?string} toRootClientId   Root client ID destination.\n * @param {number}  index            The index to move the blocks to.\n */\nexport const moveBlocksToPosition =\n\t( clientIds, fromRootClientId = '', toRootClientId = '', index ) =>\n\t( { select, dispatch } ) => {\n\t\tconst canMoveBlocks = select.canMoveBlocks(\n\t\t\tclientIds,\n\t\t\tfromRootClientId\n\t\t);\n\n\t\t// If one of the blocks is locked or the parent is locked, we cannot move any block.\n\t\tif ( ! canMoveBlocks ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If moving inside the same root block the move is always possible.\n\t\tif ( fromRootClientId !== toRootClientId ) {\n\t\t\tconst canRemoveBlocks = select.canRemoveBlocks(\n\t\t\t\tclientIds,\n\t\t\t\tfromRootClientId\n\t\t\t);\n\n\t\t\t// If we're moving to another block, it means we're deleting blocks from\n\t\t\t// the original block, so we need to check if removing is possible.\n\t\t\tif ( ! canRemoveBlocks ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst canInsertBlocks = select.canInsertBlocks(\n\t\t\t\tclientIds,\n\t\t\t\ttoRootClientId\n\t\t\t);\n\n\t\t\t// If moving to other parent block, the move is possible if we can insert a block of the same type inside the new parent block.\n\t\t\tif ( ! canInsertBlocks ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tdispatch( {\n\t\t\ttype: 'MOVE_BLOCKS_TO_POSITION',\n\t\t\tfromRootClientId,\n\t\t\ttoRootClientId,\n\t\t\tclientIds,\n\t\t\tindex,\n\t\t} );\n\t};\n\n/**\n * Action that moves given block to a new position.\n *\n * @param {?string} clientId         The client ID of the block.\n * @param {?string} fromRootClientId Root client ID source.\n * @param {?string} toRootClientId   Root client ID destination.\n * @param {number}  index            The index to move the block to.\n */\nexport function moveBlockToPosition(\n\tclientId,\n\tfromRootClientId = '',\n\ttoRootClientId = '',\n\tindex\n) {\n\treturn moveBlocksToPosition(\n\t\t[ clientId ],\n\t\tfromRootClientId,\n\t\ttoRootClientId,\n\t\tindex\n\t);\n}\n\n/**\n * Action that inserts a single block, optionally at a specific index respective a root block list.\n *\n * Only allowed blocks are inserted. The action may fail silently for blocks that are not allowed or if\n * a templateLock is active on the block list.\n *\n * @param {Object}   block           Block object to insert.\n * @param {?number}  index           Index at which block should be inserted.\n * @param {?string}  rootClientId    Optional root client ID of block list on which to insert.\n * @param {?boolean} updateSelection If true block selection will be updated. If false, block selection will not change. Defaults to true.\n * @param {?Object}  meta            Optional Meta values to be passed to the action object.\n *\n * @return {Object} Action object.\n */\nexport function insertBlock(\n\tblock,\n\tindex,\n\trootClientId,\n\tupdateSelection,\n\tmeta\n) {\n\treturn insertBlocks(\n\t\t[ block ],\n\t\tindex,\n\t\trootClientId,\n\t\tupdateSelection,\n\t\t0,\n\t\tmeta\n\t);\n}\n\n/* eslint-disable jsdoc/valid-types */\n/**\n * Action that inserts an array of blocks, optionally at a specific index respective a root block list.\n *\n * Only allowed blocks are inserted. The action may fail silently for blocks that are not allowed or if\n * a templateLock is active on the block list.\n *\n * @param {Object[]}  blocks          Block objects to insert.\n * @param {?number}   index           Index at which block should be inserted.\n * @param {?string}   rootClientId    Optional root client ID of block list on which to insert.\n * @param {?boolean}  updateSelection If true block selection will be updated.  If false, block selection will not change. Defaults to true.\n * @param {0|-1|null} initialPosition Initial focus position. Setting it to null prevent focusing the inserted block.\n * @param {?Object}   meta            Optional Meta values to be passed to the action object.\n *\n * @return {Object} Action object.\n */\nexport const insertBlocks =\n\t(\n\t\tblocks,\n\t\tindex,\n\t\trootClientId,\n\t\tupdateSelection = true,\n\t\tinitialPosition = 0,\n\t\tmeta\n\t) =>\n\t( { select, dispatch } ) => {\n\t\t/* eslint-enable jsdoc/valid-types */\n\t\tif ( initialPosition !== null && typeof initialPosition === 'object' ) {\n\t\t\tmeta = initialPosition;\n\t\t\tinitialPosition = 0;\n\t\t\tdeprecated(\n\t\t\t\t\"meta argument in wp.data.dispatch('core/block-editor')\",\n\t\t\t\t{\n\t\t\t\t\tsince: '5.8',\n\t\t\t\t\thint: 'The meta argument is now the 6th argument of the function',\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tblocks = getBlocksWithDefaultStylesApplied(\n\t\t\tcastArray( blocks ),\n\t\t\tselect.getSettings()\n\t\t);\n\t\tconst allowedBlocks = [];\n\t\tfor ( const block of blocks ) {\n\t\t\tconst isValid = select.canInsertBlockType(\n\t\t\t\tblock.name,\n\t\t\t\trootClientId\n\t\t\t);\n\t\t\tif ( isValid ) {\n\t\t\t\tallowedBlocks.push( block );\n\t\t\t}\n\t\t}\n\t\tif ( allowedBlocks.length ) {\n\t\t\tdispatch( {\n\t\t\t\ttype: 'INSERT_BLOCKS',\n\t\t\t\tblocks: allowedBlocks,\n\t\t\t\tindex,\n\t\t\t\trootClientId,\n\t\t\t\ttime: Date.now(),\n\t\t\t\tupdateSelection,\n\t\t\t\tinitialPosition: updateSelection ? initialPosition : null,\n\t\t\t\tmeta,\n\t\t\t} );\n\t\t}\n\t};\n\n/**\n * Action that shows the insertion point.\n *\n * @param    {?string}         rootClientId           Optional root client ID of block list on\n *                                                    which to insert.\n * @param    {?number}         index                  Index at which block should be inserted.\n * @param    {?Object}         __unstableOptions      Additional options.\n * @property {boolean}         __unstableWithInserter Whether or not to show an inserter button.\n * @property {WPDropOperation} operation              The operation to perform when applied,\n *                                                    either 'insert' or 'replace' for now.\n *\n * @return {Object} Action object.\n */\nexport function showInsertionPoint(\n\trootClientId,\n\tindex,\n\t__unstableOptions = {}\n) {\n\tconst { __unstableWithInserter, operation } = __unstableOptions;\n\treturn {\n\t\ttype: 'SHOW_INSERTION_POINT',\n\t\trootClientId,\n\t\tindex,\n\t\t__unstableWithInserter,\n\t\toperation,\n\t};\n}\n/**\n * Action that hides the insertion point.\n */\nexport const hideInsertionPoint =\n\t() =>\n\t( { select, dispatch } ) => {\n\t\tif ( ! select.isBlockInsertionPointVisible() ) {\n\t\t\treturn;\n\t\t}\n\t\tdispatch( {\n\t\t\ttype: 'HIDE_INSERTION_POINT',\n\t\t} );\n\t};\n\n/**\n * Action that resets the template validity.\n *\n * @param {boolean} isValid template validity flag.\n *\n * @return {Object} Action object.\n */\nexport function setTemplateValidity( isValid ) {\n\treturn {\n\t\ttype: 'SET_TEMPLATE_VALIDITY',\n\t\tisValid,\n\t};\n}\n\n/**\n * Action that synchronizes the template with the list of blocks.\n *\n * @return {Object} Action object.\n */\nexport const synchronizeTemplate =\n\t() =>\n\t( { select, dispatch } ) => {\n\t\tdispatch( { type: 'SYNCHRONIZE_TEMPLATE' } );\n\t\tconst blocks = select.getBlocks();\n\t\tconst template = select.getTemplate();\n\t\tconst updatedBlockList = synchronizeBlocksWithTemplate(\n\t\t\tblocks,\n\t\t\ttemplate\n\t\t);\n\n\t\tdispatch.resetBlocks( updatedBlockList );\n\t};\n\n/**\n * Delete the current selection.\n *\n * @param {boolean} isForward\n */\nexport const __unstableDeleteSelection =\n\t( isForward ) =>\n\t( { registry, select, dispatch } ) => {\n\t\tconst selectionAnchor = select.getSelectionStart();\n\t\tconst selectionFocus = select.getSelectionEnd();\n\n\t\tif ( selectionAnchor.clientId === selectionFocus.clientId ) return;\n\n\t\t// It's not mergeable if there's no rich text selection.\n\t\tif (\n\t\t\t! selectionAnchor.attributeKey ||\n\t\t\t! selectionFocus.attributeKey ||\n\t\t\ttypeof selectionAnchor.offset === 'undefined' ||\n\t\t\ttypeof selectionFocus.offset === 'undefined'\n\t\t)\n\t\t\treturn false;\n\n\t\tconst anchorRootClientId = select.getBlockRootClientId(\n\t\t\tselectionAnchor.clientId\n\t\t);\n\t\tconst focusRootClientId = select.getBlockRootClientId(\n\t\t\tselectionFocus.clientId\n\t\t);\n\n\t\t// It's not mergeable if the selection doesn't start and end in the same\n\t\t// block list. Maybe in the future it should be allowed.\n\t\tif ( anchorRootClientId !== focusRootClientId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockOrder = select.getBlockOrder( anchorRootClientId );\n\t\tconst anchorIndex = blockOrder.indexOf( selectionAnchor.clientId );\n\t\tconst focusIndex = blockOrder.indexOf( selectionFocus.clientId );\n\n\t\t// Reassign selection start and end based on order.\n\t\tlet selectionStart, selectionEnd;\n\n\t\tif ( anchorIndex > focusIndex ) {\n\t\t\tselectionStart = selectionFocus;\n\t\t\tselectionEnd = selectionAnchor;\n\t\t} else {\n\t\t\tselectionStart = selectionAnchor;\n\t\t\tselectionEnd = selectionFocus;\n\t\t}\n\n\t\tconst targetSelection = isForward ? selectionEnd : selectionStart;\n\t\tconst targetBlock = select.getBlock( targetSelection.clientId );\n\t\tconst targetBlockType = getBlockType( targetBlock.name );\n\n\t\tif ( ! targetBlockType.merge ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst selectionA = selectionStart;\n\t\tconst selectionB = selectionEnd;\n\n\t\tconst blockA = select.getBlock( selectionA.clientId );\n\t\tconst blockAType = getBlockType( blockA.name );\n\n\t\tconst blockB = select.getBlock( selectionB.clientId );\n\t\tconst blockBType = getBlockType( blockB.name );\n\n\t\tconst htmlA = blockA.attributes[ selectionA.attributeKey ];\n\t\tconst htmlB = blockB.attributes[ selectionB.attributeKey ];\n\n\t\tconst attributeDefinitionA =\n\t\t\tblockAType.attributes[ selectionA.attributeKey ];\n\t\tconst attributeDefinitionB =\n\t\t\tblockBType.attributes[ selectionB.attributeKey ];\n\n\t\tlet valueA = create( {\n\t\t\thtml: htmlA,\n\t\t\t...mapRichTextSettings( attributeDefinitionA ),\n\t\t} );\n\t\tlet valueB = create( {\n\t\t\thtml: htmlB,\n\t\t\t...mapRichTextSettings( attributeDefinitionB ),\n\t\t} );\n\n\t\tvalueA = remove( valueA, selectionA.offset, valueA.text.length );\n\t\tvalueB = insert( valueB, START_OF_SELECTED_AREA, 0, selectionB.offset );\n\n\t\t// Clone the blocks so we don't manipulate the original.\n\t\tconst cloneA = cloneBlock( blockA, {\n\t\t\t[ selectionA.attributeKey ]: toHTMLString( {\n\t\t\t\tvalue: valueA,\n\t\t\t\t...mapRichTextSettings( attributeDefinitionA ),\n\t\t\t} ),\n\t\t} );\n\t\tconst cloneB = cloneBlock( blockB, {\n\t\t\t[ selectionB.attributeKey ]: toHTMLString( {\n\t\t\t\tvalue: valueB,\n\t\t\t\t...mapRichTextSettings( attributeDefinitionB ),\n\t\t\t} ),\n\t\t} );\n\n\t\tconst followingBlock = isForward ? cloneA : cloneB;\n\n\t\t// We can only merge blocks with similar types\n\t\t// thus, we transform the block to merge first\n\t\tconst blocksWithTheSameType =\n\t\t\tblockA.name === blockB.name\n\t\t\t\t? [ followingBlock ]\n\t\t\t\t: switchToBlockType( followingBlock, targetBlockType.name );\n\n\t\t// If the block types can not match, do nothing\n\t\tif ( ! blocksWithTheSameType || ! blocksWithTheSameType.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet updatedAttributes;\n\n\t\tif ( isForward ) {\n\t\t\tconst blockToMerge = blocksWithTheSameType.pop();\n\t\t\tupdatedAttributes = targetBlockType.merge(\n\t\t\t\tblockToMerge.attributes,\n\t\t\t\tcloneB.attributes\n\t\t\t);\n\t\t} else {\n\t\t\tconst blockToMerge = blocksWithTheSameType.shift();\n\t\t\tupdatedAttributes = targetBlockType.merge(\n\t\t\t\tcloneA.attributes,\n\t\t\t\tblockToMerge.attributes\n\t\t\t);\n\t\t}\n\n\t\tconst newAttributeKey = retrieveSelectedAttribute( updatedAttributes );\n\n\t\tconst convertedHtml = updatedAttributes[ newAttributeKey ];\n\t\tconst convertedValue = create( {\n\t\t\thtml: convertedHtml,\n\t\t\t...mapRichTextSettings(\n\t\t\t\ttargetBlockType.attributes[ newAttributeKey ]\n\t\t\t),\n\t\t} );\n\t\tconst newOffset = convertedValue.text.indexOf( START_OF_SELECTED_AREA );\n\t\tconst newValue = remove( convertedValue, newOffset, newOffset + 1 );\n\t\tconst newHtml = toHTMLString( {\n\t\t\tvalue: newValue,\n\t\t\t...mapRichTextSettings(\n\t\t\t\ttargetBlockType.attributes[ newAttributeKey ]\n\t\t\t),\n\t\t} );\n\n\t\tupdatedAttributes[ newAttributeKey ] = newHtml;\n\n\t\tconst selectedBlockClientIds = select.getSelectedBlockClientIds();\n\t\tconst replacement = [\n\t\t\t...( isForward ? blocksWithTheSameType : [] ),\n\t\t\t{\n\t\t\t\t// Preserve the original client ID.\n\t\t\t\t...targetBlock,\n\t\t\t\tattributes: {\n\t\t\t\t\t...targetBlock.attributes,\n\t\t\t\t\t...updatedAttributes,\n\t\t\t\t},\n\t\t\t},\n\t\t\t...( isForward ? [] : blocksWithTheSameType ),\n\t\t];\n\n\t\tregistry.batch( () => {\n\t\t\tdispatch.selectionChange(\n\t\t\t\ttargetBlock.clientId,\n\t\t\t\tnewAttributeKey,\n\t\t\t\tnewOffset,\n\t\t\t\tnewOffset\n\t\t\t);\n\n\t\t\tdispatch.replaceBlocks(\n\t\t\t\tselectedBlockClientIds,\n\t\t\t\treplacement,\n\t\t\t\t0, // If we don't pass the `indexToSelect` it will default to the last block.\n\t\t\t\tselect.getSelectedBlocksInitialCaretPosition()\n\t\t\t);\n\t\t} );\n\t};\n\n/**\n * Split the current selection.\n */\nexport const __unstableSplitSelection =\n\t() =>\n\t( { select, dispatch } ) => {\n\t\tconst selectionAnchor = select.getSelectionStart();\n\t\tconst selectionFocus = select.getSelectionEnd();\n\n\t\tif ( selectionAnchor.clientId === selectionFocus.clientId ) return;\n\n\t\t// Can't split if the selection is not set.\n\t\tif (\n\t\t\t! selectionAnchor.attributeKey ||\n\t\t\t! selectionFocus.attributeKey ||\n\t\t\ttypeof selectionAnchor.offset === 'undefined' ||\n\t\t\ttypeof selectionFocus.offset === 'undefined'\n\t\t)\n\t\t\treturn;\n\n\t\tconst anchorRootClientId = select.getBlockRootClientId(\n\t\t\tselectionAnchor.clientId\n\t\t);\n\t\tconst focusRootClientId = select.getBlockRootClientId(\n\t\t\tselectionFocus.clientId\n\t\t);\n\n\t\t// It's not splittable if the selection doesn't start and end in the same\n\t\t// block list. Maybe in the future it should be allowed.\n\t\tif ( anchorRootClientId !== focusRootClientId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockOrder = select.getBlockOrder( anchorRootClientId );\n\t\tconst anchorIndex = blockOrder.indexOf( selectionAnchor.clientId );\n\t\tconst focusIndex = blockOrder.indexOf( selectionFocus.clientId );\n\n\t\t// Reassign selection start and end based on order.\n\t\tlet selectionStart, selectionEnd;\n\n\t\tif ( anchorIndex > focusIndex ) {\n\t\t\tselectionStart = selectionFocus;\n\t\t\tselectionEnd = selectionAnchor;\n\t\t} else {\n\t\t\tselectionStart = selectionAnchor;\n\t\t\tselectionEnd = selectionFocus;\n\t\t}\n\n\t\tconst selectionA = selectionStart;\n\t\tconst selectionB = selectionEnd;\n\n\t\tconst blockA = select.getBlock( selectionA.clientId );\n\t\tconst blockAType = getBlockType( blockA.name );\n\n\t\tconst blockB = select.getBlock( selectionB.clientId );\n\t\tconst blockBType = getBlockType( blockB.name );\n\n\t\tconst htmlA = blockA.attributes[ selectionA.attributeKey ];\n\t\tconst htmlB = blockB.attributes[ selectionB.attributeKey ];\n\n\t\tconst attributeDefinitionA =\n\t\t\tblockAType.attributes[ selectionA.attributeKey ];\n\t\tconst attributeDefinitionB =\n\t\t\tblockBType.attributes[ selectionB.attributeKey ];\n\n\t\tlet valueA = create( {\n\t\t\thtml: htmlA,\n\t\t\t...mapRichTextSettings( attributeDefinitionA ),\n\t\t} );\n\t\tlet valueB = create( {\n\t\t\thtml: htmlB,\n\t\t\t...mapRichTextSettings( attributeDefinitionB ),\n\t\t} );\n\n\t\tvalueA = remove( valueA, selectionA.offset, valueA.text.length );\n\t\tvalueB = remove( valueB, 0, selectionB.offset );\n\n\t\tdispatch.replaceBlocks(\n\t\t\tselect.getSelectedBlockClientIds(),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\t// Preserve the original client ID.\n\t\t\t\t\t...blockA,\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\t...blockA.attributes,\n\t\t\t\t\t\t[ selectionA.attributeKey ]: toHTMLString( {\n\t\t\t\t\t\t\tvalue: valueA,\n\t\t\t\t\t\t\t...mapRichTextSettings( attributeDefinitionA ),\n\t\t\t\t\t\t} ),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcreateBlock( getDefaultBlockName() ),\n\t\t\t\t{\n\t\t\t\t\t// Preserve the original client ID.\n\t\t\t\t\t...blockB,\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\t...blockB.attributes,\n\t\t\t\t\t\t[ selectionB.attributeKey ]: toHTMLString( {\n\t\t\t\t\t\t\tvalue: valueB,\n\t\t\t\t\t\t\t...mapRichTextSettings( attributeDefinitionB ),\n\t\t\t\t\t\t} ),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\t1, // If we don't pass the `indexToSelect` it will default to the last block.\n\t\t\tselect.getSelectedBlocksInitialCaretPosition()\n\t\t);\n\t};\n\n/**\n * Expand the selection to cover the entire blocks, removing partial selection.\n */\nexport const __unstableExpandSelection =\n\t() =>\n\t( { select, dispatch } ) => {\n\t\tconst selectionAnchor = select.getSelectionStart();\n\t\tconst selectionFocus = select.getSelectionEnd();\n\t\tdispatch.selectionChange( {\n\t\t\tstart: { clientId: selectionAnchor.clientId },\n\t\t\tend: { clientId: selectionFocus.clientId },\n\t\t} );\n\t};\n\n/**\n * Action that merges two blocks.\n *\n * @param {string} firstBlockClientId  Client ID of the first block to merge.\n * @param {string} secondBlockClientId Client ID of the second block to merge.\n */\nexport const mergeBlocks =\n\t( firstBlockClientId, secondBlockClientId ) =>\n\t( { registry, select, dispatch } ) => {\n\t\tconst blocks = [ firstBlockClientId, secondBlockClientId ];\n\t\tdispatch( { type: 'MERGE_BLOCKS', blocks } );\n\n\t\tconst [ clientIdA, clientIdB ] = blocks;\n\t\tconst blockA = select.getBlock( clientIdA );\n\t\tconst blockAType = getBlockType( blockA.name );\n\n\t\tif ( ! blockAType ) return;\n\n\t\tconst blockB = select.getBlock( clientIdB );\n\n\t\tif ( blockAType && ! blockAType.merge ) {\n\t\t\t// If there's no merge function defined, attempt merging inner\n\t\t\t// blocks.\n\t\t\tconst blocksWithTheSameType = switchToBlockType(\n\t\t\t\tblockB,\n\t\t\t\tblockAType.name\n\t\t\t);\n\t\t\t// Only focus the previous block if it's not mergeable.\n\t\t\tif ( blocksWithTheSameType?.length !== 1 ) {\n\t\t\t\tdispatch.selectBlock( blockA.clientId );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst [ blockWithSameType ] = blocksWithTheSameType;\n\t\t\tif ( blockWithSameType.innerBlocks.length < 1 ) {\n\t\t\t\tdispatch.selectBlock( blockA.clientId );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tregistry.batch( () => {\n\t\t\t\tdispatch.insertBlocks(\n\t\t\t\t\tblockWithSameType.innerBlocks,\n\t\t\t\t\tundefined,\n\t\t\t\t\tclientIdA\n\t\t\t\t);\n\t\t\t\tdispatch.removeBlock( clientIdB );\n\t\t\t\tdispatch.selectBlock(\n\t\t\t\t\tblockWithSameType.innerBlocks[ 0 ].clientId\n\t\t\t\t);\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockBType = getBlockType( blockB.name );\n\t\tconst { clientId, attributeKey, offset } = select.getSelectionStart();\n\t\tconst selectedBlockType =\n\t\t\tclientId === clientIdA ? blockAType : blockBType;\n\t\tconst attributeDefinition =\n\t\t\tselectedBlockType.attributes[ attributeKey ];\n\t\tconst canRestoreTextSelection =\n\t\t\t( clientId === clientIdA || clientId === clientIdB ) &&\n\t\t\tattributeKey !== undefined &&\n\t\t\toffset !== undefined &&\n\t\t\t// We cannot restore text selection if the RichText identifier\n\t\t\t// is not a defined block attribute key. This can be the case if the\n\t\t\t// fallback intance ID is used to store selection (and no RichText\n\t\t\t// identifier is set), or when the identifier is wrong.\n\t\t\t!! attributeDefinition;\n\n\t\tif ( ! attributeDefinition ) {\n\t\t\tif ( typeof attributeKey === 'number' ) {\n\t\t\t\twindow.console.error(\n\t\t\t\t\t`RichText needs an identifier prop that is the block attribute key of the attribute it controls. Its type is expected to be a string, but was ${ typeof attributeKey }`\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\twindow.console.error(\n\t\t\t\t\t'The RichText identifier prop does not match any attributes defined by the block.'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Clone the blocks so we don't insert the character in a \"live\" block.\n\t\tconst cloneA = cloneBlock( blockA );\n\t\tconst cloneB = cloneBlock( blockB );\n\n\t\tif ( canRestoreTextSelection ) {\n\t\t\tconst selectedBlock = clientId === clientIdA ? cloneA : cloneB;\n\t\t\tconst html = selectedBlock.attributes[ attributeKey ];\n\t\t\tconst value = insert(\n\t\t\t\tcreate( {\n\t\t\t\t\thtml,\n\t\t\t\t\t...mapRichTextSettings( attributeDefinition ),\n\t\t\t\t} ),\n\t\t\t\tSTART_OF_SELECTED_AREA,\n\t\t\t\toffset,\n\t\t\t\toffset\n\t\t\t);\n\n\t\t\tselectedBlock.attributes[ attributeKey ] = toHTMLString( {\n\t\t\t\tvalue,\n\t\t\t\t...mapRichTextSettings( attributeDefinition ),\n\t\t\t} );\n\t\t}\n\n\t\t// We can only merge blocks with similar types\n\t\t// thus, we transform the block to merge first.\n\t\tconst blocksWithTheSameType =\n\t\t\tblockA.name === blockB.name\n\t\t\t\t? [ cloneB ]\n\t\t\t\t: switchToBlockType( cloneB, blockA.name );\n\n\t\t// If the block types can not match, do nothing.\n\t\tif ( ! blocksWithTheSameType || ! blocksWithTheSameType.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Calling the merge to update the attributes and remove the block to be merged.\n\t\tconst updatedAttributes = blockAType.merge(\n\t\t\tcloneA.attributes,\n\t\t\tblocksWithTheSameType[ 0 ].attributes\n\t\t);\n\n\t\tif ( canRestoreTextSelection ) {\n\t\t\tconst newAttributeKey =\n\t\t\t\tretrieveSelectedAttribute( updatedAttributes );\n\t\t\tconst convertedHtml = updatedAttributes[ newAttributeKey ];\n\t\t\tconst convertedValue = create( {\n\t\t\t\thtml: convertedHtml,\n\t\t\t\t...mapRichTextSettings(\n\t\t\t\t\tblockAType.attributes[ newAttributeKey ]\n\t\t\t\t),\n\t\t\t} );\n\t\t\tconst newOffset = convertedValue.text.indexOf(\n\t\t\t\tSTART_OF_SELECTED_AREA\n\t\t\t);\n\t\t\tconst newValue = remove( convertedValue, newOffset, newOffset + 1 );\n\t\t\tconst newHtml = toHTMLString( {\n\t\t\t\tvalue: newValue,\n\t\t\t\t...mapRichTextSettings(\n\t\t\t\t\tblockAType.attributes[ newAttributeKey ]\n\t\t\t\t),\n\t\t\t} );\n\n\t\t\tupdatedAttributes[ newAttributeKey ] = newHtml;\n\n\t\t\tdispatch.selectionChange(\n\t\t\t\tblockA.clientId,\n\t\t\t\tnewAttributeKey,\n\t\t\t\tnewOffset,\n\t\t\t\tnewOffset\n\t\t\t);\n\t\t}\n\n\t\tdispatch.replaceBlocks(\n\t\t\t[ blockA.clientId, blockB.clientId ],\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\t...blockA,\n\t\t\t\t\tattributes: {\n\t\t\t\t\t\t...blockA.attributes,\n\t\t\t\t\t\t...updatedAttributes,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t...blocksWithTheSameType.slice( 1 ),\n\t\t\t],\n\t\t\t0 // If we don't pass the `indexToSelect` it will default to the last block.\n\t\t);\n\t};\n\n/**\n * Yields action objects used in signalling that the blocks corresponding to\n * the set of specified client IDs are to be removed.\n *\n * @param {string|string[]} clientIds      Client IDs of blocks to remove.\n * @param {boolean}         selectPrevious True if the previous block\n *                                         or the immediate parent\n *                                         (if no previous block exists)\n *                                         should be selected\n *                                         when a block is removed.\n */\nexport const removeBlocks = ( clientIds, selectPrevious = true ) =>\n\tprivateRemoveBlocks( clientIds, selectPrevious );\n\n/**\n * Returns an action object used in signalling that the block with the\n * specified client ID is to be removed.\n *\n * @param {string}  clientId       Client ID of block to remove.\n * @param {boolean} selectPrevious True if the previous block should be\n *                                 selected when a block is removed.\n *\n * @return {Object} Action object.\n */\nexport function removeBlock( clientId, selectPrevious ) {\n\treturn removeBlocks( [ clientId ], selectPrevious );\n}\n\n/* eslint-disable jsdoc/valid-types */\n/**\n * Returns an action object used in signalling that the inner blocks with the\n * specified client ID should be replaced.\n *\n * @param {string}    rootClientId    Client ID of the block whose InnerBlocks will re replaced.\n * @param {Object[]}  blocks          Block objects to insert as new InnerBlocks\n * @param {?boolean}  updateSelection If true block selection will be updated. If false, block selection will not change. Defaults to false.\n * @param {0|-1|null} initialPosition Initial block position.\n * @return {Object} Action object.\n */\nexport function replaceInnerBlocks(\n\trootClientId,\n\tblocks,\n\tupdateSelection = false,\n\tinitialPosition = 0\n) {\n\t/* eslint-enable jsdoc/valid-types */\n\treturn {\n\t\ttype: 'REPLACE_INNER_BLOCKS',\n\t\trootClientId,\n\t\tblocks,\n\t\tupdateSelection,\n\t\tinitialPosition: updateSelection ? initialPosition : null,\n\t\ttime: Date.now(),\n\t};\n}\n\n/**\n * Returns an action object used to toggle the block editing mode between\n * visual and HTML modes.\n *\n * @param {string} clientId Block client ID.\n *\n * @return {Object} Action object.\n */\nexport function toggleBlockMode( clientId ) {\n\treturn {\n\t\ttype: 'TOGGLE_BLOCK_MODE',\n\t\tclientId,\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the user has begun to type.\n *\n * @return {Object} Action object.\n */\nexport function startTyping() {\n\treturn {\n\t\ttype: 'START_TYPING',\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the user has stopped typing.\n *\n * @return {Object} Action object.\n */\nexport function stopTyping() {\n\treturn {\n\t\ttype: 'STOP_TYPING',\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the user has begun to drag blocks.\n *\n * @param {string[]} clientIds An array of client ids being dragged\n *\n * @return {Object} Action object.\n */\nexport function startDraggingBlocks( clientIds = [] ) {\n\treturn {\n\t\ttype: 'START_DRAGGING_BLOCKS',\n\t\tclientIds,\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the user has stopped dragging blocks.\n *\n * @return {Object} Action object.\n */\nexport function stopDraggingBlocks() {\n\treturn {\n\t\ttype: 'STOP_DRAGGING_BLOCKS',\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the caret has entered formatted text.\n *\n * @deprecated\n *\n * @return {Object} Action object.\n */\nexport function enterFormattedText() {\n\tdeprecated( 'wp.data.dispatch( \"core/block-editor\" ).enterFormattedText', {\n\t\tsince: '6.1',\n\t\tversion: '6.3',\n\t} );\n\treturn {\n\t\ttype: 'DO_NOTHING',\n\t};\n}\n\n/**\n * Returns an action object used in signalling that the user caret has exited formatted text.\n *\n * @deprecated\n *\n * @return {Object} Action object.\n */\nexport function exitFormattedText() {\n\tdeprecated( 'wp.data.dispatch( \"core/block-editor\" ).exitFormattedText', {\n\t\tsince: '6.1',\n\t\tversion: '6.3',\n\t} );\n\treturn {\n\t\ttype: 'DO_NOTHING',\n\t};\n}\n\n/**\n * Action that changes the position of the user caret.\n *\n * @param {string|WPSelection} clientId     The selected block client ID.\n * @param {string}             attributeKey The selected block attribute key.\n * @param {number}             startOffset  The start offset.\n * @param {number}             endOffset    The end offset.\n *\n * @return {Object} Action object.\n */\nexport function selectionChange(\n\tclientId,\n\tattributeKey,\n\tstartOffset,\n\tendOffset\n) {\n\tif ( typeof clientId === 'string' ) {\n\t\treturn {\n\t\t\ttype: 'SELECTION_CHANGE',\n\t\t\tclientId,\n\t\t\tattributeKey,\n\t\t\tstartOffset,\n\t\t\tendOffset,\n\t\t};\n\t}\n\n\treturn { type: 'SELECTION_CHANGE', ...clientId };\n}\n\n/**\n * Action that adds a new block of the default type to the block list.\n *\n * @param {?Object} attributes   Optional attributes of the block to assign.\n * @param {?string} rootClientId Optional root client ID of block list on which\n *                               to append.\n * @param {?number} index        Optional index where to insert the default block.\n */\nexport const insertDefaultBlock =\n\t( attributes, rootClientId, index ) =>\n\t( { dispatch } ) => {\n\t\t// Abort if there is no default block type (if it has been unregistered).\n\t\tconst defaultBlockName = getDefaultBlockName();\n\t\tif ( ! defaultBlockName ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst block = createBlock( defaultBlockName, attributes );\n\n\t\treturn dispatch.insertBlock( block, index, rootClientId );\n\t};\n\n/**\n * Action that changes the nested settings of a given block.\n *\n * @param {string} clientId Client ID of the block whose nested setting are\n *                          being received.\n * @param {Object} settings Object with the new settings for the nested block.\n *\n * @return {Object} Action object\n */\nexport function updateBlockListSettings( clientId, settings ) {\n\treturn {\n\t\ttype: 'UPDATE_BLOCK_LIST_SETTINGS',\n\t\tclientId,\n\t\tsettings,\n\t};\n}\n\n/**\n * Action that updates the block editor settings.\n *\n * @param {Object} settings Updated settings\n *\n * @return {Object} Action object\n */\nexport function updateSettings( settings ) {\n\treturn __experimentalUpdateSettings( settings, {\n\t\tstripExperimentalSettings: true,\n\t} );\n}\n\n/**\n * Action that signals that a temporary reusable block has been saved\n * in order to switch its temporary id with the real id.\n *\n * @param {string} id        Reusable block's id.\n * @param {string} updatedId Updated block's id.\n *\n * @return {Object} Action object.\n */\nexport function __unstableSaveReusableBlock( id, updatedId ) {\n\treturn {\n\t\ttype: 'SAVE_REUSABLE_BLOCK_SUCCESS',\n\t\tid,\n\t\tupdatedId,\n\t};\n}\n\n/**\n * Action that marks the last block change explicitly as persistent.\n *\n * @return {Object} Action object.\n */\nexport function __unstableMarkLastChangeAsPersistent() {\n\treturn { type: 'MARK_LAST_CHANGE_AS_PERSISTENT' };\n}\n\n/**\n * Action that signals that the next block change should be marked explicitly as not persistent.\n *\n * @return {Object} Action object.\n */\nexport function __unstableMarkNextChangeAsNotPersistent() {\n\treturn { type: 'MARK_NEXT_CHANGE_AS_NOT_PERSISTENT' };\n}\n\n/**\n * Action that marks the last block change as an automatic change, meaning it was not\n * performed by the user, and can be undone using the `Escape` and `Backspace` keys.\n * This action must be called after the change was made, and any actions that are a\n * consequence of it, so it is recommended to be called at the next idle period to ensure all\n * selection changes have been recorded.\n */\nexport const __unstableMarkAutomaticChange =\n\t() =>\n\t( { dispatch } ) => {\n\t\tdispatch( { type: 'MARK_AUTOMATIC_CHANGE' } );\n\t\tconst { requestIdleCallback = ( cb ) => setTimeout( cb, 100 ) } =\n\t\t\twindow;\n\t\trequestIdleCallback( () => {\n\t\t\tdispatch( { type: 'MARK_AUTOMATIC_CHANGE_FINAL' } );\n\t\t} );\n\t};\n\n/**\n * Action that enables or disables the navigation mode.\n *\n * @param {boolean} isNavigationMode Enable/Disable navigation mode.\n */\nexport const setNavigationMode =\n\t( isNavigationMode = true ) =>\n\t( { dispatch } ) => {\n\t\tdispatch.__unstableSetEditorMode(\n\t\t\tisNavigationMode ? 'navigation' : 'edit'\n\t\t);\n\t};\n\n/**\n * Action that sets the editor mode\n *\n * @param {string} mode Editor mode\n */\nexport const __unstableSetEditorMode =\n\t( mode ) =>\n\t( { dispatch, select } ) => {\n\t\t// When switching to zoom-out mode, we need to select the root block\n\t\tif ( mode === 'zoom-out' ) {\n\t\t\tconst firstSelectedClientId = select.getBlockSelectionStart();\n\t\t\tif ( firstSelectedClientId ) {\n\t\t\t\tdispatch.selectBlock(\n\t\t\t\t\tselect.getBlockHierarchyRootClientId(\n\t\t\t\t\t\tfirstSelectedClientId\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tdispatch( { type: 'SET_EDITOR_MODE', mode } );\n\n\t\tif ( mode === 'navigation' ) {\n\t\t\tspeak(\n\t\t\t\t__(\n\t\t\t\t\t'You are currently in navigation mode. Navigate blocks using the Tab key and Arrow keys. Use Left and Right Arrow keys to move between nesting levels. To exit navigation mode and edit the selected block, press Enter.'\n\t\t\t\t)\n\t\t\t);\n\t\t} else if ( mode === 'edit' ) {\n\t\t\tspeak(\n\t\t\t\t__(\n\t\t\t\t\t'You are currently in edit mode. To return to the navigation mode, press Escape.'\n\t\t\t\t)\n\t\t\t);\n\t\t} else if ( mode === 'zoom-out' ) {\n\t\t\tspeak( __( 'You are currently in zoom-out mode.' ) );\n\t\t}\n\t};\n\n/**\n * Action that enables or disables the block moving mode.\n *\n * @param {string|null} hasBlockMovingClientId Enable/Disable block moving mode.\n */\nexport const setBlockMovingClientId =\n\t( hasBlockMovingClientId = null ) =>\n\t( { dispatch } ) => {\n\t\tdispatch( { type: 'SET_BLOCK_MOVING_MODE', hasBlockMovingClientId } );\n\n\t\tif ( hasBlockMovingClientId ) {\n\t\t\tspeak(\n\t\t\t\t__(\n\t\t\t\t\t'Use the Tab key and Arrow keys to choose new block location. Use Left and Right Arrow keys to move between nesting levels. Once location is selected press Enter or Space to move the block.'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n\n/**\n * Action that duplicates a list of blocks.\n *\n * @param {string[]} clientIds\n * @param {boolean}  updateSelection\n */\nexport const duplicateBlocks =\n\t( clientIds, updateSelection = true ) =>\n\t( { select, dispatch } ) => {\n\t\tif ( ! clientIds || ! clientIds.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Return early if blocks don't exist.\n\t\tconst blocks = select.getBlocksByClientId( clientIds );\n\t\tif ( blocks.some( ( block ) => ! block ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Return early if blocks don't support multiple usage.\n\t\tconst blockNames = blocks.map( ( block ) => block.name );\n\t\tif (\n\t\t\tblockNames.some(\n\t\t\t\t( blockName ) =>\n\t\t\t\t\t! hasBlockSupport( blockName, 'multiple', true )\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootClientId = select.getBlockRootClientId( clientIds[ 0 ] );\n\t\tconst clientIdsArray = castArray( clientIds );\n\t\tconst lastSelectedIndex = select.getBlockIndex(\n\t\t\tclientIdsArray[ clientIdsArray.length - 1 ]\n\t\t);\n\t\tconst clonedBlocks = blocks.map( ( block ) =>\n\t\t\t__experimentalCloneSanitizedBlock( block )\n\t\t);\n\t\tdispatch.insertBlocks(\n\t\t\tclonedBlocks,\n\t\t\tlastSelectedIndex + 1,\n\t\t\trootClientId,\n\t\t\tupdateSelection\n\t\t);\n\t\tif ( clonedBlocks.length > 1 && updateSelection ) {\n\t\t\tdispatch.multiSelect(\n\t\t\t\tclonedBlocks[ 0 ].clientId,\n\t\t\t\tclonedBlocks[ clonedBlocks.length - 1 ].clientId\n\t\t\t);\n\t\t}\n\t\treturn clonedBlocks.map( ( block ) => block.clientId );\n\t};\n\n/**\n * Action that inserts an empty block before a given block.\n *\n * @param {string} clientId\n */\nexport const insertBeforeBlock =\n\t( clientId ) =>\n\t( { select, dispatch } ) => {\n\t\tif ( ! clientId ) {\n\t\t\treturn;\n\t\t}\n\t\tconst rootClientId = select.getBlockRootClientId( clientId );\n\t\tconst isLocked = select.getTemplateLock( rootClientId );\n\t\tif ( isLocked ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstSelectedIndex = select.getBlockIndex( clientId );\n\t\treturn dispatch.insertDefaultBlock(\n\t\t\t{},\n\t\t\trootClientId,\n\t\t\tfirstSelectedIndex\n\t\t);\n\t};\n\n/**\n * Action that inserts an empty block after a given block.\n *\n * @param {string} clientId\n */\nexport const insertAfterBlock =\n\t( clientId ) =>\n\t( { select, dispatch } ) => {\n\t\tif ( ! clientId ) {\n\t\t\treturn;\n\t\t}\n\t\tconst rootClientId = select.getBlockRootClientId( clientId );\n\t\tconst isLocked = select.getTemplateLock( rootClientId );\n\t\tif ( isLocked ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstSelectedIndex = select.getBlockIndex( clientId );\n\t\treturn dispatch.insertDefaultBlock(\n\t\t\t{},\n\t\t\trootClientId,\n\t\t\tfirstSelectedIndex + 1\n\t\t);\n\t};\n\n/**\n * Action that toggles the highlighted block state.\n *\n * @param {string}  clientId      The block's clientId.\n * @param {boolean} isHighlighted The highlight state.\n */\nexport function toggleBlockHighlight( clientId, isHighlighted ) {\n\treturn {\n\t\ttype: 'TOGGLE_BLOCK_HIGHLIGHT',\n\t\tclientId,\n\t\tisHighlighted,\n\t};\n}\n\n/**\n * Action that \"flashes\" the block with a given `clientId` by rhythmically highlighting it.\n *\n * @param {string} clientId Target block client ID.\n */\nexport const flashBlock =\n\t( clientId ) =>\n\tasync ( { dispatch } ) => {\n\t\tdispatch( toggleBlockHighlight( clientId, true ) );\n\t\tawait new Promise( ( resolve ) => setTimeout( resolve, 150 ) );\n\t\tdispatch( toggleBlockHighlight( clientId, false ) );\n\t};\n\n/**\n * Action that sets whether a block has controlled inner blocks.\n *\n * @param {string}  clientId                 The block's clientId.\n * @param {boolean} hasControlledInnerBlocks True if the block's inner blocks are controlled.\n */\nexport function setHasControlledInnerBlocks(\n\tclientId,\n\thasControlledInnerBlocks\n) {\n\treturn {\n\t\ttype: 'SET_HAS_CONTROLLED_INNER_BLOCKS',\n\t\thasControlledInnerBlocks,\n\t\tclientId,\n\t};\n}\n\n/**\n * Action that sets whether given blocks are visible on the canvas.\n *\n * @param {Record<string,boolean>} updates For each block's clientId, its new visibility setting.\n */\nexport function setBlockVisibility( updates ) {\n\treturn {\n\t\ttype: 'SET_BLOCK_VISIBILITY',\n\t\tupdates,\n\t};\n}\n\n/**\n * Action that sets whether a block is being temporaritly edited as blocks.\n *\n * DO-NOT-USE in production.\n * This action is created for internal/experimental only usage and may be\n * removed anytime without any warning, causing breakage on any plugin or theme invoking it.\n *\n * @param {?string} temporarilyEditingAsBlocks The block's clientId being temporaritly edited as blocks.\n */\nexport function __unstableSetTemporarilyEditingAsBlocks(\n\ttemporarilyEditingAsBlocks\n) {\n\treturn {\n\t\ttype: 'SET_TEMPORARILY_EDITING_AS_BLOCKS',\n\t\ttemporarilyEditingAsBlocks,\n\t};\n}\n\n/**\n * Interface for inserter media requests.\n *\n * @typedef {Object} InserterMediaRequest\n * @property {number} per_page How many items to fetch per page.\n * @property {string} search   The search term to use for filtering the results.\n */\n\n/**\n * Interface for inserter media responses. Any media resource should\n * map their response to this interface, in order to create the core\n * WordPress media blocks (image, video, audio).\n *\n * @typedef {Object} InserterMediaItem\n * @property {string}        title        The title of the media item.\n * @property {string}        url          The source url of the media item.\n * @property {string}        [previewUrl] The preview source url of the media item to display in the media list.\n * @property {number}        [id]         The WordPress id of the media item.\n * @property {number|string} [sourceId]   The id of the media item from external source.\n * @property {string}        [alt]        The alt text of the media item.\n * @property {string}        [caption]    The caption of the media item.\n */\n\n/**\n * Registers a new inserter media category. Once registered, the media category is\n * available in the inserter's media tab.\n *\n * The following interfaces are used:\n *\n * _Type Definition_\n *\n * - _InserterMediaRequest_ `Object`: Interface for inserter media requests.\n *\n * _Properties_\n *\n * - _per_page_ `number`: How many items to fetch per page.\n * - _search_ `string`: The search term to use for filtering the results.\n *\n * _Type Definition_\n *\n * - _InserterMediaItem_ `Object`: Interface for inserter media responses. Any media resource should\n * map their response to this interface, in order to create the core\n * WordPress media blocks (image, video, audio).\n *\n * _Properties_\n *\n * - _title_ `string`: The title of the media item.\n * - _url_ `string: The source url of the media item.\n * - _previewUrl_ `[string]`: The preview source url of the media item to display in the media list.\n * - _id_ `[number]`: The WordPress id of the media item.\n * - _sourceId_ `[number|string]`: The id of the media item from external source.\n * - _alt_ `[string]`: The alt text of the media item.\n * - _caption_ `[string]`: The caption of the media item.\n *\n * @param    {InserterMediaCategory}                                  category                       The inserter media category to register.\n *\n * @example\n * ```js\n *\n * wp.data.dispatch('core/block-editor').registerInserterMediaCategory( {\n * \t name: 'openverse',\n * \t labels: {\n * \t \tname: 'Openverse',\n * \t \tsearch_items: 'Search Openverse',\n * \t },\n * \t mediaType: 'image',\n * \t async fetch( query = {} ) {\n * \t \tconst defaultArgs = {\n * \t \t\tmature: false,\n * \t \t\texcluded_source: 'flickr,inaturalist,wikimedia',\n * \t \t\tlicense: 'pdm,cc0',\n * \t \t};\n * \t \tconst finalQuery = { ...query, ...defaultArgs };\n * \t \t// Sometimes you might need to map the supported request params according to `InserterMediaRequest`.\n * \t \t// interface. In this example the `search` query param is named `q`.\n * \t \tconst mapFromInserterMediaRequest = {\n * \t \t\tper_page: 'page_size',\n * \t \t\tsearch: 'q',\n * \t \t};\n * \t \tconst url = new URL( 'https://api.openverse.engineering/v1/images/' );\n * \t \tObject.entries( finalQuery ).forEach( ( [ key, value ] ) => {\n * \t \t\tconst queryKey = mapFromInserterMediaRequest[ key ] || key;\n * \t \t\turl.searchParams.set( queryKey, value );\n * \t \t} );\n * \t \tconst response = await window.fetch( url, {\n * \t \t\theaders: {\n * \t \t\t\t'User-Agent': 'WordPress/inserter-media-fetch',\n * \t \t\t},\n * \t \t} );\n * \t \tconst jsonResponse = await response.json();\n * \t \tconst results = jsonResponse.results;\n * \t \treturn results.map( ( result ) => ( {\n * \t \t\t...result,\n * \t \t\t// If your response result includes an `id` prop that you want to access later, it should\n * \t \t\t// be mapped to `InserterMediaItem`'s `sourceId` prop. This can be useful if you provide\n * \t \t\t// a report URL getter.\n * \t \t\t// Additionally you should always clear the `id` value of your response results because\n * \t \t\t// it is used to identify WordPress media items.\n * \t \t\tsourceId: result.id,\n * \t \t\tid: undefined,\n * \t \t\tcaption: result.caption,\n * \t \t\tpreviewUrl: result.thumbnail,\n * \t \t} ) );\n * \t },\n * \t getReportUrl: ( { sourceId } ) =>\n * \t \t`https://wordpress.org/openverse/image/${ sourceId }/report/`,\n * \t isExternalResource: true,\n * } );\n * ```\n *\n * @typedef {Object} InserterMediaCategory Interface for inserter media category.\n * @property {string}                                                 name                           The name of the media category, that should be unique among all media categories.\n * @property {Object}                                                 labels                         Labels for the media category.\n * @property {string}                                                 labels.name                    General name of the media category. It's used in the inserter media items list.\n * @property {string}                                                 [labels.search_items='Search'] Label for searching items. Default is ‘Search Posts’ / ‘Search Pages’.\n * @property {('image'|'audio'|'video')}                              mediaType                      The media type of the media category.\n * @property {(InserterMediaRequest) => Promise<InserterMediaItem[]>} fetch                          The function to fetch media items for the category.\n * @property {(InserterMediaItem) => string}                          [getReportUrl]                 If the media category supports reporting media items, this function should return\n *                                                                                                   the report url for the media item. It accepts the `InserterMediaItem` as an argument.\n * @property {boolean}                                                [isExternalResource]           If the media category is an external resource, this should be set to true.\n *                                                                                                   This is used to avoid making a request to the external resource when the user\n *\n */\nexport const registerInserterMediaCategory =\n\t( category ) =>\n\t( { select, dispatch } ) => {\n\t\tif ( ! category || typeof category !== 'object' ) {\n\t\t\tconsole.error(\n\t\t\t\t'Category should be an `InserterMediaCategory` object.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tif ( ! category.name ) {\n\t\t\tconsole.error(\n\t\t\t\t'Category should have a `name` that should be unique among all media categories.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tif ( ! category.labels?.name ) {\n\t\t\tconsole.error( 'Category should have a `labels.name`.' );\n\t\t\treturn;\n\t\t}\n\t\tif ( ! [ 'image', 'audio', 'video' ].includes( category.mediaType ) ) {\n\t\t\tconsole.error(\n\t\t\t\t'Category should have `mediaType` property that is one of `image|audio|video`.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tif ( ! category.fetch || typeof category.fetch !== 'function' ) {\n\t\t\tconsole.error(\n\t\t\t\t'Category should have a `fetch` function defined with the following signature `(InserterMediaRequest) => Promise<InserterMediaItem[]>`.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tconst { inserterMediaCategories = [] } = select.getSettings();\n\t\tif (\n\t\t\tinserterMediaCategories.some(\n\t\t\t\t( { name } ) => name === category.name\n\t\t\t)\n\t\t) {\n\t\t\tconsole.error(\n\t\t\t\t`A category is already registered with the same name: \"${ category.name }\".`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tif (\n\t\t\tinserterMediaCategories.some(\n\t\t\t\t( { labels: { name } } ) => name === category.labels?.name\n\t\t\t)\n\t\t) {\n\t\t\tconsole.error(\n\t\t\t\t`A category is already registered with the same labels.name: \"${ category.labels.name }\".`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\t// `inserterMediaCategories` is a private block editor setting, which means it cannot\n\t\t// be updated through the public `updateSettings` action. We preserve this setting as\n\t\t// private, so extenders can only add new inserter media categories and don't have any\n\t\t// control over the core media categories.\n\t\tdispatch( {\n\t\t\ttype: 'UPDATE_SETTINGS',\n\t\t\tsettings: {\n\t\t\t\tinserterMediaCategories: [\n\t\t\t\t\t...inserterMediaCategories,\n\t\t\t\t\t{ ...category, isExternalResource: true },\n\t\t\t\t],\n\t\t\t},\n\t\t} );\n\t};\n"]}
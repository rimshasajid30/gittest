{"version":3,"sources":["@wordpress/rich-text/src/component/use-select-object.js"],"names":["useSelectObject","element","onClick","event","target","textContent","isContentEditable","ownerDocument","defaultView","selection","getSelection","containsNode","range","createRange","selectNode","removeAllRanges","addRange","preventDefault","onFocusIn","relatedTarget","contains","tagName","addEventListener","removeEventListener"],"mappings":";;;;;;;AAGA;;AAHA;AACA;AACA;AAGO,SAASA,eAAT,GAA2B;AACjC,SAAO,2BAAgBC,OAAF,IAAe;AACnC,aAASC,OAAT,CAAkBC,KAAlB,EAA0B;AACzB,YAAM;AAAEC,QAAAA;AAAF,UAAaD,KAAnB,CADyB,CAGzB;;AACA,UACCC,MAAM,KAAKH,OAAX,IACEG,MAAM,CAACC,WAAP,IAAsBD,MAAM,CAACE,iBAFhC,EAGE;AACD;AACA;;AAED,YAAM;AAAEC,QAAAA;AAAF,UAAoBH,MAA1B;AACA,YAAM;AAAEI,QAAAA;AAAF,UAAkBD,aAAxB;AACA,YAAME,SAAS,GAAGD,WAAW,CAACE,YAAZ,EAAlB,CAbyB,CAezB;AACA;;AACA,UAAKD,SAAS,CAACE,YAAV,CAAwBP,MAAxB,CAAL,EAAwC;AAExC,YAAMQ,KAAK,GAAGL,aAAa,CAACM,WAAd,EAAd;AAEAD,MAAAA,KAAK,CAACE,UAAN,CAAkBV,MAAlB;AACAK,MAAAA,SAAS,CAACM,eAAV;AACAN,MAAAA,SAAS,CAACO,QAAV,CAAoBJ,KAApB;AAEAT,MAAAA,KAAK,CAACc,cAAN;AACA;;AAED,aAASC,SAAT,CAAoBf,KAApB,EAA4B;AAC3B;AACA,UACCA,KAAK,CAACgB,aAAN,IACA,CAAElB,OAAO,CAACmB,QAAR,CAAkBjB,KAAK,CAACgB,aAAxB,CADF,IAEAhB,KAAK,CAACgB,aAAN,CAAoBE,OAApB,KAAgC,GAHjC,EAIE;AACDnB,QAAAA,OAAO,CAAEC,KAAF,CAAP;AACA;AACD;;AAEDF,IAAAA,OAAO,CAACqB,gBAAR,CAA0B,OAA1B,EAAmCpB,OAAnC;AACAD,IAAAA,OAAO,CAACqB,gBAAR,CAA0B,SAA1B,EAAqCJ,SAArC;AACA,WAAO,MAAM;AACZjB,MAAAA,OAAO,CAACsB,mBAAR,CAA6B,OAA7B,EAAsCrB,OAAtC;AACAD,MAAAA,OAAO,CAACsB,mBAAR,CAA6B,SAA7B,EAAwCL,SAAxC;AACA,KAHD;AAIA,GA9CM,EA8CJ,EA9CI,CAAP;AA+CA","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRefEffect } from '@wordpress/compose';\n\nexport function useSelectObject() {\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onClick( event ) {\n\t\t\tconst { target } = event;\n\n\t\t\t// If the child element has no text content, it must be an object.\n\t\t\tif (\n\t\t\t\ttarget === element ||\n\t\t\t\t( target.textContent && target.isContentEditable )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ownerDocument } = target;\n\t\t\tconst { defaultView } = ownerDocument;\n\t\t\tconst selection = defaultView.getSelection();\n\n\t\t\t// If it's already selected, do nothing and let default behavior\n\t\t\t// happen. This means it's \"click-through\".\n\t\t\tif ( selection.containsNode( target ) ) return;\n\n\t\t\tconst range = ownerDocument.createRange();\n\n\t\t\trange.selectNode( target );\n\t\t\tselection.removeAllRanges();\n\t\t\tselection.addRange( range );\n\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tfunction onFocusIn( event ) {\n\t\t\t// When there is incoming focus from a link, select the object.\n\t\t\tif (\n\t\t\t\tevent.relatedTarget &&\n\t\t\t\t! element.contains( event.relatedTarget ) &&\n\t\t\t\tevent.relatedTarget.tagName === 'A'\n\t\t\t) {\n\t\t\t\tonClick( event );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'click', onClick );\n\t\telement.addEventListener( 'focusin', onFocusIn );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'click', onClick );\n\t\t\telement.removeEventListener( 'focusin', onFocusIn );\n\t\t};\n\t}, [] );\n}\n"]}